size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.3, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "black"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg / ha)")+
xlab("Application rate (kg / ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.3, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "black"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "black"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "grey10"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "grey5"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "grey20"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "grey30"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "grey25"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
ggplot()+
geom_boxplot(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), color = "black",
alpha = 0.6, lwd = 0.6)+
geom_jitter(data = crd_dfw,
aes(x = rate_kgha, y = yield_kgha,
fill = rate_kgha), alpha = 0.5,
width = 0.4, shape = 21)+
geom_label(data = crd_cld_selected,
aes(x = rate_kgha, y = emmean,
label = letter,vjust = -0.15),
label.size = NA, size = 6,
alpha = 0)+
scale_y_continuous(limits = c(600,7500))+
facet_wrap(~element, scales = "free",
nrow = 1)+
theme_bw()+
theme(
panel.spacing.x = unit(4, "lines"),
panel.background = element_rect(fill = 'lightgrey'),
strip.background = element_rect(fill = "grey27"),
strip.text = element_text(size = 14,
face = "bold",
color = "white"),
axis.title.y = element_text(
size = 16,
face = "bold",
margin = margin(r = 25)),
axis.title.x = element_text(
size = 16,
face = "bold",
margin = margin(t = 25)),
axis.text.y = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
axis.text.x = element_text(
margin = margin(t = 5),
size = 10,
face = "bold"),
legend.position = "none")+
ylab("Yield (kg/ha)")+
xlab("Application rate (kg/ha)")+
scale_fill_npg()+
scale_color_npg()
crd_dfw|>
ggplot(aes(x = nrate_kgha, y = yield_kgha,
color = nrate_kgha))+
geom_boxplot()+
geom_jitter(alpha = 0.4)+
theme(
legend.position = "none"
)+
scale_color_npg()
crd_dfw <- crd_df |>
mutate_at(
vars(krate_kgha,nrate_kgha,rep), as.factor)|>
mutate(
trt_name = paste0(krate_kgha,"+",nrate_kgha)
)
crd_dfw|>
ggplot(aes(x = nrate_kgha, y = yield_kgha,
color = nrate_kgha))+
geom_boxplot()+
geom_jitter(alpha = 0.4)+
theme(
legend.position = "none"
)+
scale_color_npg()
# Changing to sum-to-zero contrast
options(contrasts = c("contr.sum", "contr.poly"))
# attach dataframe to include in model
attach(crd_dfw)
# Model fitting
crd_mod <- lm(yield_kgha ~ nrate_kgha*krate_kgha)
# Summary
summary(crd_mod)
Anova(crd_mod, type = 3)
crd_dfw|>
ggplot(aes(x = nrate_kgha, y = yield_kgha,
color = nrate_kgha))+
geom_boxplot()+
geom_jitter(alpha = 0.4)+
theme(
legend.position = "none"
)+
scale_color_npg()
#| echo: false
#| #| fig-width: 2
#| fig-height: 3
ggplot(crd_dfw, aes(x = krate_kgha,
y = yield_kgha,
color = krate_kgha)) +
geom_boxplot() +
geom_jitter(alpha = 0.4) +
theme(legend.position = "none")+
scale_color_npg()
crd_dfw |>
ggplot(aes(x = nrate_kgha, y = yield_kgha,
color = nrate_kgha,))+
geom_boxplot()+
geom_jitter(alpha = 0.4)+
facet_grid(~krate_kgha)+
theme(legend.position = "none")+
scale_color_npg()
# Changing to sum-to-zero contrast
options(contrasts = c("contr.sum", "contr.poly"))
# attach dataframe to include in model
attach(crd_dfw)
# Model fitting
crd_mod <- lm(yield_kgha ~ nrate_kgha*krate_kgha)
# Summary
summary(crd_mod)
Anova(crd_mod, type = 3)
# Model fitting
crd_mod <- lm(yield_kgha ~ nrate_kgha*krate_kgha,
data = crd_dfw)
# Summary
summary(crd_mod)
Anova(crd_mod, type = 3)
View(crd_dfw)
# Model fitting
crd_mod <- lm(yield_kgha ~ nrate_kgha * krate_kgha,
data = crd_dfw)
# Summary
summary(crd_mod)
Anova(crd_mod, type = 3)
