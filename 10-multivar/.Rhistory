#| message: false
#| warning: false
#install.packages("ggcorrplot")
#install.packages("factoextra")
#install.packages("ggpmisc")
library(tidyverse)
library(ggcorrplot)
library(broom)
library(car)
library(factoextra)
library(ggpmisc)
#| message: false
#| warning: false
#install.packages("ggcorrplot")
#install.packages("factoextra")
#install.packages("ggpmisc")
library(tidyverse)
library(ggcorrplot)
library(broom)
library(car)
library(factoextra)
library(ggpmisc)
#| message: false
#| warning: false
#install.packages("ggcorrplot")
#install.packages("factoextra")
#install.packages("ggpmisc")
library(tidyverse)
library(ggcorrplot)
library(broom)
library(car)
library(factoextra)
library(ggpmisc)
weather <- read_csv("data/weather_monthsum.csv")
weather <- read_csv("data/weather_monthsum.csv",
show_col_types = F)
# Estimating significance matrix
p.mat <- weather |>
dplyr::select(-year,-site)
View(p.mat)
# Estimating significance matrix
p.mat <- weather |>
dplyr::select(-year,-site)|>
ggcorrplot::cor_pmat()
View(p.mat)
weather %>%
dplyr::select(-year, -site) %>%
cor() %>%
ggcorrplot(hc.order = TRUE,
digits = 1,
type = "lower",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
lab = TRUE)
ggsave("output/corrmat.png",
height = 25,
width = 22,
bg = "white")
weather %>%
dplyr::select(-year, -site) %>%
cor() %>% # calculates r (-1 to 1)
as.data.frame() %>%
rownames_to_column() %>%
pivot_longer(cols = -rowname) %>%
filter(abs(value) > .85 & value != 1) %>%
arrange(desc(value)) %>%
distinct(value, .keep_all = T)
high_corr <- weather %>%
dplyr::select(-year, -site) %>%
cor() %>% # calculates r (-1 to 1)
as.data.frame() %>%
rownames_to_column() %>%
pivot_longer(cols = -rowname) %>%
filter(abs(value) > .85 & value != 1) %>%
arrange(desc(value)) %>%
distinct(value, .keep_all = T)
View(high_corr)
low_corr <- weather %>%
dplyr::select(-year, -site) %>%
cor() %>% # calculates r (-1 to 1)
as.data.frame() %>%
rownames_to_column() %>%
pivot_longer(cols = -rowname) %>%
filter(abs(value) < .05 & value != 1) %>%
arrange(abs(value)) %>%
distinct(value, .keep_all = T)
View(low_corr)
weather %>%
dplyr::select(-site, -year) %>%
pivot_longer(cols=-strength_gtex) %>%
group_by(name) %>%
nest() %>%
mutate(r2 = map_dbl(data,
~lm(strength_gtex ~ value,
data = .x) %>%
glance(.) %>%
pull(r.squared)
)) %>%
arrange(desc(r2))
weather %>%
dplyr::select(-site, -year) %>%
pivot_longer(cols=-strength_gtex) %>%
group_by(name) %>%
nest() %>%
mutate(r2 = map_dbl(data,
~lm(strength_gtex ~ value,
data = .x) %>%
glance(.) %>%
pull(r.squared)
)) %>%
arrange(desc(r2)) %>%
ungroup() %>%
slice(1:6) %>%
unnest(data) %>%
ggplot(aes(x = value,
y = strength_gtex))+
geom_point(shape = 21,
alpha = .7,
fill = "purple")+
geom_smooth(method = "lm",
se = F,
color = "black",
size = 1)+
facet_wrap(~name,
scales = "free_x",
ncol=2)
weather %>%
ggplot(aes(x = mean_dayl.s_Apr,
y = sum_prcp.mm_Oct)) +
geom_point() +
geom_smooth(method="lm") +
stat_correlation()
weather %>%
ggplot(aes(x = mean_dayl.s_Apr,
y = mean_dayl.s_May))+
geom_point() +
geom_smooth(method="lm")
weather %>%
ggplot(aes(x = mean_dayl.s_Apr,
y = mean_dayl.s_May))+
geom_point() +
geom_smooth(method="lm")+
stat_correlation()
lm_dayl.apr <- lm(strength_gtex ~  mean_dayl.s_Apr,
data = weather)
lm_dayl.apr
lm_dayl.apr <- lm(strength_gtex ~  mean_dayl.s_Apr,
data = weather) |>
broom::tidy()
View(lm_dayl.apr)
lm_dayl.apr <- lm(strength_gtex ~  mean_dayl.s_Apr,
data = weather) |>
broom::tidy() |>
filter(!term == "(Intercept)")
lm_dayl.apr <- lm(strength_gtex ~  mean_dayl.s_Apr,
data = weather) |>
broom::tidy() |>
filter(!term == "(Intercept)") |>
mutate(mod = "lm_dayl.s_Apr")
lm_dayl.apr <- lm(strength_gtex ~  mean_dayl.s_Apr,
data = weather) |>
broom::tidy() |>
filter(!term == "(Intercept)") |>
mutate(mod = "lm_dayl.s_apr")
lm_prp.oct <- lm(strength_gtex ~ sum_prcp.mm_Oct,
data = weather) %>%
tidy() %>%
filter(term!="(Intercept)") %>%
mutate(mod="lm_prp.oct")
View(lm_prp.oct)
lm_dayl.prcp <- lm(strength_gtex ~ mean_dayl.s_Apr +
sum_prcp.mm_Oct,
data = weather) %>%
tidy() %>%
filter(term != "(Intercept)") %>%
mutate(mod = "lm_2var.uncor")
View(lm_dayl.prcp)
lm_daylapr.daylmay <- lm(strength_gtex ~ mean_dayl.s_Apr +
mean_dayl.s_May,
data = weather) %>%
tidy() %>%
filter(term!="(Intercept)") %>%
mutate(mod="lm_2var.cor")
View(lm_daylapr.daylmay)
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod))
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))
lm_daylapr.daylmay <- lm(strength_gtex ~ mean_dayl.s_Apr +
mean_dayl.s_May,
data = weather) %>%
tidy() %>%
filter(term!="(Intercept)") %>%
mutate(mod="lm_2var.cor")
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")
lm_dayl.apr <- lm(strength_gtex ~  mean_dayl.s_Apr,
data = weather) |>
broom::tidy() |>
filter(!term == "(Intercept)") |>
mutate(mod = "lm_dayl.s_apr")
lm_prp.oct <- lm(strength_gtex ~ sum_prcp.mm_Oct,
data = weather) %>%
tidy() %>%
filter(term!="(Intercept)") %>%
mutate(mod="lm_prp.oct")
lm_dayl.prcp <- lm(strength_gtex ~ mean_dayl.s_Apr +
sum_prcp.mm_Oct,
data = weather) %>%
tidy() %>%
filter(term != "(Intercept)") %>%
mutate(mod = "lm_2var.uncor")
lm_daylapr.daylmay <- lm(strength_gtex ~ mean_dayl.s_Apr +
mean_dayl.s_May,
data = weather) %>%
tidy() %>%
filter(term!="(Intercept)") %>%
mutate(mod="lm_2var.cor")
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")+
scael_x_discrete(guide = guide_axis(n.dodge = 2))
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") %>%
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")+
scale_x_discrete(guide = guide_axis(n.dodge = 2))
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May")
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
drop_na()|>
filter(term != "mean_dayl.s_May")
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
drop_na()|>
filter(term != "mean_dayl.s_May") |>
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")+
scale_x_discrete(guide = guide_axis(n.dodge = 2))
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") |>
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")+
scale_x_discrete(guide = guide_axis(n.dodge = 2))
test <- lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay) %>%
mutate(mod=factor(mod,
levels=c("lm_dayl.apr",
"lm_prp.oct",
"lm_2var.uncor",
"lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May")
View(test)
lm_daylapr.daylmay <- lm(strength_gtex ~ mean_dayl.s_Apr +
mean_dayl.s_May,
data = weather) %>%
tidy() %>%
filter(term!="(Intercept)") %>%
mutate(mod="lm_2var.cor")
View(lm_daylapr.daylmay)
test <- lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay)
test <- lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay)|>
# mutate(mod=factor(mod,
#                   levels=c("lm_dayl.apr",
#                            "lm_prp.oct",
#                            "lm_2var.uncor",
#                            "lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May")
test <- lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay)|>
# mutate(mod=factor(mod,
#                   levels=c("lm_dayl.apr",
#                            "lm_prp.oct",
#                            "lm_2var.uncor",
#                            "lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") |>
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")+
scale_x_discrete(guide = guide_axis(n.dodge = 2))
lm_dayl.apr %>%
bind_rows(lm_prp.oct,
lm_dayl.prcp,
lm_daylapr.daylmay)|>
# mutate(mod=factor(mod,
#                   levels=c("lm_dayl.apr",
#                            "lm_prp.oct",
#                            "lm_2var.uncor",
#                            "lm_2var.cor"))) %>%
filter(term != "mean_dayl.s_May") |>
ggplot(aes(x=mod)) +
geom_pointrange(aes(y = estimate,
ymin = estimate - std.error,
ymax = estimate + std.error))+
facet_wrap(~term, scales = "free_y")+
scale_x_discrete(guide = guide_axis(n.dodge = 2))
# Uncorrelated
lm(strength_gtex ~ mean_dayl.s_Apr +
sum_prcp.mm_Oct,
data = weather) |>
vif()
# Correlated
lm(strength_gtex ~ mean_dayl.s_Apr +
mean_dayl.s_May,
data = weather) %>%
vif()
